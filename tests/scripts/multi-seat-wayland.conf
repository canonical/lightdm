#
# Check that non-seat0 Wayland sessions are started properly.
#

[Seat:*]
user-session=wayland

#?*START-DAEMON
#?RUNNER DAEMON-START

# seat0 starts.
#?XSERVER-0 START VT=7 SEAT=seat0
#?*XSERVER-0 INDICATE-READY
#?XSERVER-0 INDICATE-READY
#?XSERVER-0 ACCEPT-CONNECT
#?GREETER-X-0 START XDG_SEAT=seat0 XDG_VTNR=7 XDG_SESSION_CLASS=greeter
#?LOGIN1 ACTIVATE-SESSION SESSION=c0
#?XSERVER-0 ACCEPT-CONNECT
#?GREETER-X-0 CONNECT-XSERVER
#?GREETER-X-0 CONNECT-TO-DAEMON
#?GREETER-X-0 CONNECTED-TO-DAEMON

# Add seat1.
#?*ADD-SEAT ID=seat1
#?XSERVER-1 START SEAT=seat1
#?*XSERVER-1 INDICATE-READY
#?XSERVER-1 INDICATE-READY
#?XSERVER-1 ACCEPT-CONNECT
#?GREETER-X-1 START XDG_SEAT=seat1 XDG_SESSION_CLASS=greeter
#?LOGIN1 ACTIVATE-SESSION SESSION=c1
#?XSERVER-1 ACCEPT-CONNECT
#?GREETER-X-1 CONNECT-XSERVER
#?GREETER-X-1 CONNECT-TO-DAEMON
#?GREETER-X-1 CONNECTED-TO-DAEMON

# Log in to seat1.
#?*GREETER-X-1 AUTHENTICATE USERNAME=no-password2
#?GREETER-X-1 AUTHENTICATION-COMPLETE USERNAME=no-password2 AUTHENTICATED=TRUE
#?*GREETER-X-1 START-SESSION
#?GREETER-X-1 TERMINATE SIGNAL=15
#?XSERVER-1 TERMINATE SIGNAL=15
#?SESSION-WAYLAND START XDG_SEAT=seat1 XDG_GREETER_DATA_DIR=.*/no-password2 XDG_SESSION_TYPE=wayland XDG_SESSION_DESKTOP=wayland USER=no-password2
#?LOGIN1 ACTIVATE-SESSION SESSION=c2

# Ensure that the X server and greeter for seat1 are not restarted until after
# the user logs out.
#?*WAIT
#?*FENCE

# Log out.  The X server and greeter for seat1 should start again.
#?*SESSION-WAYLAND LOGOUT
#?XSERVER-1 START SEAT=seat1
#?*XSERVER-1 INDICATE-READY
#?XSERVER-1 INDICATE-READY
#?XSERVER-1 ACCEPT-CONNECT
#?GREETER-X-1 START XDG_SEAT=seat1 XDG_SESSION_CLASS=greeter
#?LOGIN1 ACTIVATE-SESSION SESSION=c3
#?XSERVER-1 ACCEPT-CONNECT
#?GREETER-X-1 CONNECT-XSERVER
#?GREETER-X-1 CONNECT-TO-DAEMON
#?GREETER-X-1 CONNECTED-TO-DAEMON

# Clean up.
#?*STOP-DAEMON
#?GREETER-X-0 TERMINATE SIGNAL=15
#?XSERVER-0 TERMINATE SIGNAL=15
#?GREETER-X-1 TERMINATE SIGNAL=15
#?XSERVER-1 TERMINATE SIGNAL=15
#?RUNNER DAEMON-EXIT STATUS=0
